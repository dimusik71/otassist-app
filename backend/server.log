+ exec gosu vibecode scripts/start --hot
Installing dependencies and generating Prisma client...
[0.03ms] ".env"
bun install v1.2.19 (aad3abea)

$ prisma generate
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma

âœ” Generated Prisma Client (v6.17.1) to ./generated/prisma in 230ms

Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)

Tip: Want to turn off tips and other hints? https://pris.ly/tip-4-nohints


Checked 760 installs across 702 packages (no changes) [1.53s]
Starting server in dev mode with hot reload...
$ NODE_ENV=development bun run --hot src/index.ts
Failed to find Response internal state key
âœ… Environment variables validated successfully
ğŸ” [Auth] Initializing Better Auth...
âœ… [Auth] Better Auth initialized
ğŸ”— [Auth] Base URL: https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸŒ [Auth] Trusted origins: vibecode://, http://localhost:3000, https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸ“ [Upload] Uploads directory exists: /home/user/workspace/backend/uploads
ğŸ”§ Initializing Hono application...
ğŸ” Mounting Better Auth handler at /api/auth/*
ğŸ“ Serving static files from uploads/ directory
ğŸ“¤ Mounting upload routes at /api/upload
ğŸ‘¥ Mounting clients routes at /api/clients
ğŸ“‹ Mounting assessments routes at /api/assessments
ğŸ› ï¸  Mounting equipment routes at /api/equipment
ğŸ’° Mounting quotes routes at /api/quotes
ğŸ“„ Mounting invoices routes at /api/invoices
ğŸ¤– Mounting AI routes at /api/ai
ğŸ  Mounting house map routes at /api
ğŸ“± Mounting IoT devices routes at /api
âš™ï¸  Starting server...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Environment: development
ğŸš€ Server is running on port 3000
ğŸ”— Base URL: http://localhost:3000
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š Available endpoints:
  ğŸ” Auth:       /api/auth/*
  ğŸ“¤ Upload:     POST /api/upload/image
  ğŸ‘¥ Clients:    GET/POST /api/clients
  ğŸ“‹ Assess:     GET/POST /api/assessments
  ğŸ› ï¸  Equipment:  GET/POST /api/equipment
  ğŸ’° Quotes:     POST /api/quotes
  ğŸ“„ Invoices:   POST /api/invoices
  ğŸ¤– AI:         POST /api/ai/*
  ğŸ  House Maps: GET/POST /api/house-maps
  ğŸ“± IoT:        GET/POST /api/iot-devices
  ğŸ’š Health:     GET /health
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Failed to find Response internal state key
âœ… Environment variables validated successfully
ğŸ” [Auth] Initializing Better Auth...
âœ… [Auth] Better Auth initialized
ğŸ”— [Auth] Base URL: https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸŒ [Auth] Trusted origins: vibecode://, http://localhost:3000, https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸ“ [Upload] Uploads directory exists: /home/user/workspace/backend/uploads
ğŸ”§ Initializing Hono application...
ğŸ” Mounting Better Auth handler at /api/auth/*
ğŸ“ Serving static files from uploads/ directory
ğŸ“¤ Mounting upload routes at /api/upload
ğŸ‘¥ Mounting clients routes at /api/clients
ğŸ“‹ Mounting assessments routes at /api/assessments
ğŸ› ï¸  Mounting equipment routes at /api/equipment
ğŸ’° Mounting quotes routes at /api/quotes
ğŸ“„ Mounting invoices routes at /api/invoices
ğŸ¤– Mounting AI routes at /api/ai
ğŸ  Mounting house map routes at /api
ğŸ“± Mounting IoT devices routes at /api
âš™ï¸  Starting server...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Environment: development
ğŸš€ Server is running on port 3000
ğŸ”— Base URL: http://localhost:3000
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š Available endpoints:
  ğŸ” Auth:       /api/auth/*
  ğŸ“¤ Upload:     POST /api/upload/image
  ğŸ‘¥ Clients:    GET/POST /api/clients
  ğŸ“‹ Assess:     GET/POST /api/assessments
  ğŸ› ï¸  Equipment:  GET/POST /api/equipment
  ğŸ’° Quotes:     POST /api/quotes
  ğŸ“„ Invoices:   POST /api/invoices
  ğŸ¤– AI:         POST /api/ai/*
  ğŸ  House Maps: GET/POST /api/house-maps
  ğŸ“± IoT:        GET/POST /api/iot-devices
  ğŸ’š Health:     GET /health
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

<-- GET /api/auth/get-session
--> GET /api/auth/get-session [32m200[0m 11ms
<-- GET /api/assessments
--> GET /api/assessments [32m200[0m 4ms
<-- GET /api/invoices/cmi33f72k0003m25xix3z5mfn
--> GET /api/invoices/cmi33f72k0003m25xix3z5mfn [32m200[0m 4ms
<-- GET /api/quotes/cmi33f72k0003m25xix3z5mfn
<-- GET /api/assessments/cmi33f72k0003m25xix3z5mfn
--> GET /api/quotes/cmi33f72k0003m25xix3z5mfn [32m200[0m 4ms
--> GET /api/assessments/cmi33f72k0003m25xix3z5mfn [32m200[0m 4ms
<-- GET /api/assessments/cmi33f72k0003m25xix3z5mfn
--> GET /api/assessments/cmi33f72k0003m25xix3z5mfn [32m200[0m 3ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 2s
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 584ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 692ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 629ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 722ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 661ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 709ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 698ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 680ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 616ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 710ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 623ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 631ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 685ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 681ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 699ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 644ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 770ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 693ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 641ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 702ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 683ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 654ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 625ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 665ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 761ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 665ms
<-- POST /api/ai/analyze-video-frame
OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 359 |     });
360 | 
361 |     if (!response.ok) {
362 |       const errorData = await response.json().catch(() => ({}));
363 |       console.error("OpenAI API error (analyze-video-frame):", response.status, errorData);
364 |       throw new Error(`OpenAI API request failed: ${response.status} - ${JSON.stringify(errorData)}`);
                  ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:364:13)

--> POST /api/ai/analyze-video-frame [31m500[0m 656ms
<-- POST /api/ai/analyze-video-frame
Failed to find Response internal state key
âœ… Environment variables validated successfully
ğŸ” [Auth] Initializing Better Auth...
âœ… [Auth] Better Auth initialized
ğŸ”— [Auth] Base URL: https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸŒ [Auth] Trusted origins: vibecode://, http://localhost:3000, https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸ“ [Upload] Uploads directory exists: /home/user/workspace/backend/uploads
ğŸ”§ Initializing Hono application...
ğŸ” Mounting Better Auth handler at /api/auth/*
ğŸ“ Serving static files from uploads/ directory
ğŸ“¤ Mounting upload routes at /api/upload
ğŸ‘¥ Mounting clients routes at /api/clients
ğŸ“‹ Mounting assessments routes at /api/assessments
ğŸ› ï¸  Mounting equipment routes at /api/equipment
ğŸ’° Mounting quotes routes at /api/quotes
ğŸ“„ Mounting invoices routes at /api/invoices
ğŸ¤– Mounting AI routes at /api/ai
ğŸ  Mounting house map routes at /api
ğŸ“± Mounting IoT devices routes at /api
âš™ï¸  Starting server...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Environment: development
ğŸš€ Server is running on port 3000
ğŸ”— Base URL: http://localhost:3000
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š Available endpoints:
  ğŸ” Auth:       /api/auth/*
  ğŸ“¤ Upload:     POST /api/upload/image
  ğŸ‘¥ Clients:    GET/POST /api/clients
  ğŸ“‹ Assess:     GET/POST /api/assessments
  ğŸ› ï¸  Equipment:  GET/POST /api/equipment
  ğŸ’° Quotes:     POST /api/quotes
  ğŸ“„ Invoices:   POST /api/invoices
  ğŸ¤– AI:         POST /api/ai/*
  ğŸ  House Maps: GET/POST /api/house-maps
  ğŸ“± IoT:        GET/POST /api/iot-devices
  ğŸ’š Health:     GET /health
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

OpenAI API error (analyze-video-frame): 401 {
  error: {
    message: "Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.",
    type: "invalid_request_error",
    param: null,
    code: "invalid_api_key",
  },
}
Video frame analysis error: 378 |   }
379 | 
380 |   try {
381 |     // Verify assessment ownership
382 |     const assessment = await db.assessment.findFirst({
383 |       where: { id: assessmentId, userId: user.id },
            ^
error: OpenAI API request failed: 401 - {"error":{"message":"Incorrect API key provided: undefined. You can find your API key at https://platform.openai.com/account/api-keys.","type":"invalid_request_error","param":null,"code":"invalid_api_key"}}
      at <anonymous> (/home/user/workspace/backend/src/routes/ai.ts:383:7)

--> POST /api/ai/analyze-video-frame [31m500[0m 830ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 523ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 550ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 583ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 534ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 559ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 543ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 551ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 551ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 681ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 560ms
Failed to find Response internal state key
âœ… Environment variables validated successfully
ğŸ” [Auth] Initializing Better Auth...
âœ… [Auth] Better Auth initialized
ğŸ”— [Auth] Base URL: https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸŒ [Auth] Trusted origins: vibecode://, http://localhost:3000, https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸ“ [Upload] Uploads directory exists: /home/user/workspace/backend/uploads
ğŸ”§ Initializing Hono application...
ğŸ” Mounting Better Auth handler at /api/auth/*
ğŸ“ Serving static files from uploads/ directory
ğŸ“¤ Mounting upload routes at /api/upload
ğŸ‘¥ Mounting clients routes at /api/clients
ğŸ“‹ Mounting assessments routes at /api/assessments
ğŸ› ï¸  Mounting equipment routes at /api/equipment
ğŸ’° Mounting quotes routes at /api/quotes
ğŸ“„ Mounting invoices routes at /api/invoices
ğŸ¤– Mounting AI routes at /api/ai
ğŸ  Mounting house map routes at /api
ğŸ“± Mounting IoT devices routes at /api
âš™ï¸  Starting server...
<-- POST /api/ai/analyze-video-frame
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Environment: development
ğŸš€ Server is running on port 3000
ğŸ”— Base URL: http://localhost:3000
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š Available endpoints:
  ğŸ” Auth:       /api/auth/*
  ğŸ“¤ Upload:     POST /api/upload/image
  ğŸ‘¥ Clients:    GET/POST /api/clients
  ğŸ“‹ Assess:     GET/POST /api/assessments
  ğŸ› ï¸  Equipment:  GET/POST /api/equipment
  ğŸ’° Quotes:     POST /api/quotes
  ğŸ“„ Invoices:   POST /api/invoices
  ğŸ¤– AI:         POST /api/ai/*
  ğŸ  House Maps: GET/POST /api/house-maps
  ğŸ“± IoT:        GET/POST /api/iot-devices
  ğŸ’š Health:     GET /health
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

--> POST /api/ai/analyze-video-frame [32m200[0m 542ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 547ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 564ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 546ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 550ms
Failed to find Response internal state key
âœ… Environment variables validated successfully
ğŸ” [Auth] Initializing Better Auth...
âœ… [Auth] Better Auth initialized
ğŸ”— [Auth] Base URL: https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸŒ [Auth] Trusted origins: vibecode://, http://localhost:3000, https://preview-plwxyuhmoudq.share.sandbox.dev
ğŸ“ [Upload] Uploads directory exists: /home/user/workspace/backend/uploads
ğŸ”§ Initializing Hono application...
ğŸ” Mounting Better Auth handler at /api/auth/*
ğŸ“ Serving static files from uploads/ directory
ğŸ“¤ Mounting upload routes at /api/upload
ğŸ‘¥ Mounting clients routes at /api/clients
ğŸ“‹ Mounting assessments routes at /api/assessments
ğŸ› ï¸  Mounting equipment routes at /api/equipment
ğŸ’° Mounting quotes routes at /api/quotes
ğŸ“„ Mounting invoices routes at /api/invoices
ğŸ¤– Mounting AI routes at /api/ai
ğŸ  Mounting house map routes at /api
ğŸ“± Mounting IoT devices routes at /api
âš™ï¸  Starting server...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Environment: development
ğŸš€ Server is running on port 3000
ğŸ”— Base URL: http://localhost:3000
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š Available endpoints:
  ğŸ” Auth:       /api/auth/*
  ğŸ“¤ Upload:     POST /api/upload/image
  ğŸ‘¥ Clients:    GET/POST /api/clients
  ğŸ“‹ Assess:     GET/POST /api/assessments
  ğŸ› ï¸  Equipment:  GET/POST /api/equipment
  ğŸ’° Quotes:     POST /api/quotes
  ğŸ“„ Invoices:   POST /api/invoices
  ğŸ¤– AI:         POST /api/ai/*
  ğŸ  House Maps: GET/POST /api/house-maps
  ğŸ“± IoT:        GET/POST /api/iot-devices
  ğŸ’š Health:     GET /health
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 544ms
<-- POST /api/ai/analyze-video-frame
--> POST /api/ai/analyze-video-frame [32m200[0m 562ms
